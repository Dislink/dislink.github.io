<!DOCTYPE html>
<head>
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?">
	<title>图片转mcfunction | By Dislink</title>
	<script>
		function createFile(fileName, content) {
			var aTag = document.createElement('a');
			var blob = new Blob([content]);
			aTag.download = fileName;
			aTag.href = URL.createObjectURL(blob);
			aTag.click();
			URL.revokeObjectURL(blob);
		}
		function getBlock(r, g, b, mode=0/*true:标准差最小 false:方差最小*/, rWeight=1/*红色权重*/, gWeight=1/*绿色权重*/, bWeight=1/*蓝色权重*/, caWeight=1/*相对差值权重*/){
			let diffMin=Infinity;
			let diffMinItem;
			for(let item in palette){
				if((mode?((Math.abs(palette[item].R-r)*rWeight+Math.abs(palette[item].G-g)*gWeight+Math.abs(palette[item].B-b)*bWeight)-(caWeight?((((palette[item].R-r)/(r?r:1))-((palette[item].G-g)/(g?g:1)))**2+(((palette[item].G-g)/(g?g:1))-((palette[item].B-b)/(b?b:1)))**2+(((palette[item].B-b)/(b?b:1))-((palette[item].R-r)/(r?r:1)))**2)*caWeight:0)):(((palette[item].R-r)**2*rWeight+(palette[item].G-g)**2*gWeight+(palette[item].B-b)**2*bWeight)-(caWeight?((((palette[item].R-r)/(r?r:1))-((palette[item].G-g)/(g?g:1)))**2+(((palette[item].G-g)/(g?g:1))-((palette[item].B-b)/(b?b:1)))**2+(((palette[item].B-b)/(b?b:1))-((palette[item].R-r)/(r?r:1)))**2)*caWeight:0)))<diffMin){
					diffMin=(mode?((Math.abs(palette[item].R-r)*rWeight+Math.abs(palette[item].G-g)*gWeight+Math.abs(palette[item].B-b)*bWeight)):(((palette[item].R-r)**2*rWeight+(palette[item].G-g)**2*gWeight+(palette[item].B-b)**2*bWeight)));
					diffMinItem=palette[item];
				}
			}
			return diffMinItem;
		}
		var paletteJE=[{"name":"stone","R":129,"G":129,"B":129},{"name":"granite","R":137,"G":95,"B":78},{"name":"polished_granite","R":154,"G":104,"B":86},{"name":"diorite","R":198,"G":198,"B":199},{"name":"polished_diorite","R":201,"G":201,"B":202},{"name":"andesite","R":134,"G":135,"B":134},{"name":"polished_andesite","R":125,"G":128,"B":128},{"name":"dirt","R":122,"G":86,"B":59},{"name":"red_concrete","R":139,"G":32,"B":32},{"name":"warped_nylium","R":36,"G":122,"B":107},{"name":"cobblestone","R":119,"G":119,"B":119},{"name":"oak_planks","R":160,"G":129,"B":77},{"name":"spruce_planks","R":107,"G":78,"B":45},{"name":"birch_planks","R":181,"G":164,"B":115},{"name":"jungle_planks","R":148,"G":105,"B":73},{"name":"acacia_planks","R":158,"G":84,"B":46},{"name":"dark_oak_planks","R":61,"G":39,"B":18},{"name":"crimson_planks","R":94,"G":45,"B":65},{"name":"warped_planks","R":37,"G":94,"B":89},{"name":"bedrock","R":76,"G":76,"B":76},{"name":"gold_ore","R":166,"G":157,"B":123},{"name":"iron_ore","R":148,"G":135,"B":126},{"name":"coal_ore","R":99,"G":99,"B":99},{"name":"oak_log","R":114,"G":89,"B":52},{"name":"spruce_log","R":57,"G":37,"B":17},{"name":"birch_log","R":206,"G":203,"B":200},{"name":"jungle_log","R":82,"G":65,"B":24},{"name":"acacia_log","R":102,"G":95,"B":86},{"name":"dark_oak_log","R":58,"G":44,"B":25},{"name":"crimson_stem","R":87,"G":27,"B":34},{"name":"warped_stem","R":61,"G":50,"B":71},{"name":"stripped_oak_log","R":184,"G":151,"B":92},{"name":"stripped_spruce_log","R":116,"G":89,"B":52},{"name":"stripped_birch_log","R":199,"G":179,"B":121},{"name":"stripped_jungle_log","R":174,"G":133,"B":88},{"name":"stripped_acacia_log","R":177,"G":91,"B":59},{"name":"stripped_dark_oak_log","R":100,"G":78,"B":50},{"name":"stripped_crimson_stem","R":143,"G":60,"B":94},{"name":"stripped_warped_stem","R":61,"G":156,"B":154},{"name":"sponge","R":194,"G":192,"B":72},{"name":"wet_sponge","R":157,"G":170,"B":68},{"name":"lapis_ore","R":86,"G":104,"B":136},{"name":"lapis_block","R":30,"G":67,"B":134},{"name":"sandstone","R":220,"G":211,"B":168},{"name":"white_wool","R":227,"G":230,"B":230},{"name":"orange_wool","R":235,"G":113,"B":17},{"name":"magenta_wool","R":184,"G":65,"B":174},{"name":"light_blue_wool","R":55,"G":170,"B":212},{"name":"yellow_wool","R":243,"G":192,"B":37},{"name":"lime_wool","R":108,"G":180,"B":24},{"name":"pink_wool","R":232,"G":132,"B":164},{"name":"gray_wool","R":61,"G":66,"B":69},{"name":"light_gray_wool","R":138,"G":138,"B":131},{"name":"cyan_wool","R":21,"G":132,"B":141},{"name":"purple_wool","R":116,"G":39,"B":166},{"name":"blue_wool","R":51,"G":54,"B":153},{"name":"brown_wool","R":110,"G":69,"B":38},{"name":"green_wool","R":81,"G":105,"B":27},{"name":"red_wool","R":155,"G":37,"B":33},{"name":"black_wool","R":18,"G":19,"B":23},{"name":"gold_block","R":249,"G":215,"B":65},{"name":"iron_block","R":223,"G":223,"B":223},{"name":"smooth_quartz","R":231,"G":224,"B":217},{"name":"smooth_red_sandstone","R":178,"G":96,"B":30},{"name":"smooth_sandstone","R":220,"G":211,"B":169},{"name":"smooth_stone","R":163,"G":163,"B":163},{"name":"bricks","R":159,"G":103,"B":88},{"name":"mossy_cobblestone","R":107,"G":117,"B":91},{"name":"obsidian","R":23,"G":17,"B":37},{"name":"purpur_block","R":158,"G":114,"B":157},{"name":"purpur_pillar","R":166,"G":124,"B":166},{"name":"diamond_ore","R":122,"G":163,"B":160},{"name":"diamond_block","R":105,"G":243,"B":228},{"name":"redstone_ore","R":141,"G":80,"B":80},{"name":"snow_block","R":247,"G":251,"B":251},{"name":"clay","R":157,"G":163,"B":176},{"name":"pumpkin","R":186,"G":107,"B":19},{"name":"netherrack","R":94,"G":35,"B":35},{"name":"soul_soil","R":82,"G":62,"B":50},{"name":"basalt","R":85,"G":86,"B":91},{"name":"polished_basalt","R":106,"G":105,"B":106},{"name":"glowstone","R":171,"G":129,"B":89},{"name":"stone_bricks","R":111,"G":110,"B":111},{"name":"mossy_stone_bricks","R":107,"G":112,"B":101},{"name":"cracked_stone_bricks","R":105,"G":105,"B":105},{"name":"chiseled_stone_bricks","R":124,"G":123,"B":124},{"name":"melon","R":101,"G":137,"B":30},{"name":"nether_bricks","R":43,"G":21,"B":25},{"name":"cracked_nether_bricks","R":35,"G":17,"B":20},{"name":"chiseled_nether_bricks","R":53,"G":25,"B":31},{"name":"end_stone","R":216,"G":219,"B":157},{"name":"end_stone_bricks","R":202,"G":204,"B":149},{"name":"emerald_ore","R":98,"G":142,"B":112},{"name":"emerald_block","R":39,"G":212,"B":97},{"name":"nether_quartz_ore","R":121,"G":72,"B":66},{"name":"chiseled_quartz_block","R":230,"G":224,"B":216},{"name":"quartz_block","R":231,"G":225,"B":218},{"name":"quartz_bricks","R":228,"G":222,"B":213},{"name":"quartz_pillar","R":232,"G":227,"B":222},{"name":"white_terracotta","R":205,"G":174,"B":158},{"name":"orange_terracotta","R":158,"G":81,"B":36},{"name":"magenta_terracotta","R":146,"G":85,"B":106},{"name":"light_blue_terracotta","R":111,"G":106,"B":134},{"name":"yellow_terracotta","R":182,"G":129,"B":34},{"name":"lime_terracotta","R":101,"G":115,"B":51},{"name":"pink_terracotta","R":158,"G":75,"B":76},{"name":"gray_terracotta","R":56,"G":41,"B":34},{"name":"light_gray_terracotta","R":132,"G":104,"B":95},{"name":"cyan_terracotta","R":84,"G":88,"B":88},{"name":"purple_terracotta","R":115,"G":69,"B":83},{"name":"blue_terracotta","R":73,"G":58,"B":89},{"name":"brown_terracotta","R":75,"G":49,"B":34},{"name":"green_terracotta","R":74,"G":80,"B":41},{"name":"red_terracotta","R":140,"G":59,"B":46},{"name":"black_terracotta","R":36,"G":22,"B":16},{"name":"hay_block","R":162,"G":136,"B":36},{"name":"terracotta","R":149,"G":91,"B":66},{"name":"coal_block","R":20,"G":20,"B":20},{"name":"packed_ice","R":137,"G":176,"B":247},{"name":"prismarine","R":100,"G":163,"B":146},{"name":"prismarine_bricks","R":93,"G":168,"B":156},{"name":"dark_prismarine","R":50,"G":89,"B":74},{"name":"sea_lantern","R":221,"G":230,"B":222},{"name":"red_sandstone","R":181,"G":97,"B":32},{"name":"magma_block","R":155,"G":76,"B":37},{"name":"nether_wart_block","R":115,"G":3,"B":1},{"name":"warped_wart_block","R":23,"G":114,"B":117},{"name":"red_nether_bricks","R":64,"G":5,"B":7},{"name":"bone_block","R":225,"G":222,"B":205},{"name":"white_concrete","R":203,"G":209,"B":210},{"name":"orange_concrete","R":220,"G":95,"B":0},{"name":"magenta_concrete","R":165,"G":47,"B":155},{"name":"light_blue_concrete","R":34,"G":133,"B":194},{"name":"yellow_concrete","R":235,"G":172,"B":21},{"name":"lime_concrete","R":92,"G":165,"B":23},{"name":"pink_concrete","R":209,"G":98,"B":139},{"name":"gray_concrete","R":53,"G":56,"B":60},{"name":"light_gray_concrete","R":123,"G":123,"B":113},{"name":"cyan_concrete","R":21,"G":116,"B":132},{"name":"purple_concrete","R":98,"G":30,"B":153},{"name":"blue_concrete","R":43,"G":45,"B":140},{"name":"brown_concrete","R":94,"G":58,"B":30},{"name":"green_concrete","R":72,"G":89,"B":35},{"name":"black_concrete","R":8,"G":10,"B":15},{"name":"blue_ice","R":114,"G":166,"B":250},{"name":"dried_kelp_block","R":73,"G":77,"B":59},{"name":"netherite_block","R":60,"G":56,"B":58},{"name":"ancient_debris","R":85,"G":57,"B":49},{"name":"crying_obsidian","R":48,"G":13,"B":89},{"name":"blackstone","R":45,"G":39,"B":47},{"name":"gilded_blackstone","R":70,"G":53,"B":34},{"name":"polished_blackstone","R":51,"G":46,"B":52},{"name":"chiseled_polished_blackstone","R":63,"G":59,"B":70},{"name":"polished_blackstone_bricks","R":34,"G":27,"B":30},{"name":"cracked_polished_blackstone_bricks","R":31,"G":24,"B":23},{"name":"crafting_table","R":130,"G":81,"B":47},{"name":"furnace","R":108,"G":107,"B":107},{"name":"jukebox","R":83,"G":58,"B":41},{"name":"brown_mushroom_block","R":145,"G":109,"B":79},{"name":"red_mushroom_block","R":197,"G":43,"B":41},{"name":"mushroom_stem","R":201,"G":194,"B":184},{"name":"slime_block","R":109,"G":178,"B":89},{"name":"shulker_box","R":123,"G":85,"B":123},{"name":"white_shulker_box","R":185,"G":189,"B":189},{"name":"orange_shulker_box","R":198,"G":92,"B":11},{"name":"magenta_shulker_box","R":149,"G":49,"B":140},{"name":"light_blue_shulker_box","R":46,"G":143,"B":177},{"name":"yellow_shulker_box","R":205,"G":159,"B":27},{"name":"lime_shulker_box","R":89,"G":150,"B":19},{"name":"pink_shulker_box","R":194,"G":108,"B":135},{"name":"gray_shulker_box","R":48,"G":52,"B":54},{"name":"light_gray_shulker_box","R":110,"G":110,"B":103},{"name":"cyan_shulker_box","R":17,"G":106,"B":116},{"name":"purple_shulker_box","R":91,"G":29,"B":134},{"name":"blue_shulker_box","R":40,"G":41,"B":123},{"name":"brown_shulker_box","R":90,"G":56,"B":31},{"name":"green_shulker_box","R":66,"G":85,"B":24},{"name":"red_shulker_box","R":124,"G":28,"B":27},{"name":"black_shulker_box","R":22,"G":22,"B":26},{"name":"white_glazed_terracotta","R":169,"G":203,"B":210},{"name":"orange_glazed_terracotta","R":196,"G":126,"B":53},{"name":"magenta_glazed_terracotta","R":194,"G":83,"B":179},{"name":"light_blue_glazed_terracotta","R":90,"G":151,"B":199},{"name":"yellow_glazed_terracotta","R":231,"G":190,"B":92},{"name":"lime_glazed_terracotta","R":157,"G":183,"B":36},{"name":"pink_glazed_terracotta","R":235,"G":155,"B":182},{"name":"gray_glazed_terracotta","R":68,"G":72,"B":75},{"name":"light_gray_glazed_terracotta","R":157,"G":172,"B":174},{"name":"cyan_glazed_terracotta","R":42,"G":98,"B":101},{"name":"purple_glazed_terracotta","R":105,"G":55,"B":143},{"name":"blue_glazed_terracotta","R":60,"G":84,"B":179},{"name":"brown_glazed_terracotta","R":144,"G":97,"B":64},{"name":"green_glazed_terracotta","R":82,"G":106,"B":30},{"name":"red_glazed_terracotta","R":175,"G":53,"B":48},{"name":"black_glazed_terracotta","R":85,"G":27,"B":29},{"name":"loom","R":153,"G":132,"B":108},{"name":"barrel","R":104,"G":79,"B":50},{"name":"blast_furnace","R":74,"G":73,"B":75},{"name":"cartography_table","R":70,"G":45,"B":21},{"name":"shroomlight","R":241,"G":155,"B":81},{"name":"bee_nest","R":182,"G":138,"B":67},{"name":"beehive","R":181,"G":146,"B":92},{"name":"honeycomb_block","R":222,"G":137,"B":20},{"name":"lodestone","R":135,"G":135,"B":136},{"name":"respawn_anchor","R":20,"G":11,"B":28},{"name":"note_block","R":101,"G":61,"B":40},{"name":"redstone_lamp","R":112,"G":64,"B":34},{"name":"observer","R":95,"G":95,"B":95},{"name":"redstone_block","R":129,"G":15,"B":1},{"name":"target","R":221,"G":164,"B":151}];
		paletteBE=[{"name":" log2 0","R":103,"G":97,"B":87},{"name":" log2 4","R":151,"G":89,"B":55},{"name":" planks ","R":168,"G":90,"B":50},{"name":" stone 5","R":136,"G":136,"B":137},{"name":" bedrock 0","R":85,"G":85,"B":85},{"name":" log 2","R":217,"G":215,"B":210},{"name":" log 6","R":193,"G":179,"B":135},{"name":" planks 2","R":192,"G":175,"B":121},{"name":" concrete 15","R":8,"G":10,"B":15},{"name":" concrete_powder 15","R":25,"G":27,"B":32},{"name":" black_glazed_terracotta 4","R":68,"G":30,"B":32},{"name":" stained_hardened_clay 15","R":37,"G":23,"B":16},{"name":" wool 15","R":21,"G":21,"B":26},{"name":" concrete 11","R":45,"G":47,"B":143},{"name":" concrete_powder 11","R":70,"G":73,"B":167},{"name":" blue_glazed_terracotta 4","R":47,"G":65,"B":139},{"name":" stained_hardened_clay 11","R":74,"G":60,"B":91},{"name":" wool 11","R":53,"G":57,"B":157},{"name":" bone_block 0","R":229,"G":226,"B":208},{"name":" bone_block 4","R":210,"G":206,"B":179},{"name":" bookshelf 0","R":117,"G":95,"B":60},{"name":" brick_block 0","R":151,"G":98,"B":83},{"name":" concrete 12","R":96,"G":60,"B":32},{"name":" concrete_powder 12","R":126,"G":85,"B":54},{"name":" brown_glazed_terracotta 4","R":120,"G":106,"B":86},{"name":" stained_hardened_clay 12","R":77,"G":51,"B":36},{"name":" wool 12","R":114,"G":72,"B":41},{"name":" quartz_block 1","R":232,"G":227,"B":218},{"name":" quartz_block 5","R":232,"G":227,"B":217},{"name":" red_sandstone 1","R":183,"G":97,"B":28},{"name":" sandstone 1","R":216,"G":203,"B":155},{"name":" stonebrick 3","R":120,"G":119,"B":120},{"name":" clay 0","R":161,"G":166,"B":179},{"name":" coal_block 0","R":16,"G":16,"B":16},{"name":" coal_ore 0","R":116,"G":116,"B":116},{"name":" dirt 1","R":119,"G":86,"B":59},{"name":" cobblestone 0","R":128,"G":127,"B":128},{"name":" stonebrick 2","R":118,"G":118,"B":118},{"name":" crafting_table 0","R":129,"G":106,"B":70},{"name":" red_sandstone 2","R":189,"G":102,"B":32},{"name":" sandstone 2","R":218,"G":206,"B":160},{"name":" concrete 9","R":21,"G":119,"B":136},{"name":" concrete_powder 9","R":37,"G":148,"B":157},{"name":" cyan_glazed_terracotta 4","R":52,"G":119,"B":125},{"name":" stained_hardened_clay 9","R":87,"G":91,"B":91},{"name":" wool 9","R":21,"G":138,"B":145},{"name":" log2 1","R":60,"G":47,"B":26},{"name":" log2 5","R":65,"G":43,"B":21},{"name":" planks 5","R":67,"G":43,"B":20},{"name":" diamond_block 0","R":98,"G":237,"B":228},{"name":" diamond_ore 0","R":125,"G":143,"B":141},{"name":" stone 3","R":189,"G":188,"B":189},{"name":" dirt 0","R":134,"G":96,"B":67},{"name":" emerald_block 0","R":42,"G":203,"B":88},{"name":" emerald_ore 0","R":117,"G":137,"B":124},{"name":" end_stone 0","R":220,"G":223,"B":158},{"name":" end_bricks 0","R":218,"G":224,"B":162},{"name":" gold_block 0","R":246,"G":208,"B":62},{"name":" gold_ore 0","R":144,"G":140,"B":125},{"name":" stone 1","R":149,"G":103,"B":86},{"name":" gravel 0","R":132,"G":127,"B":127},{"name":" concrete 7","R":55,"G":58,"B":62},{"name":" concrete_powder 7","R":77,"G":81,"B":85},{"name":" gray_glazed_terracotta 4","R":83,"G":90,"B":94},{"name":" stained_hardened_clay 7","R":58,"G":42,"B":36},{"name":" wool 7","R":63,"G":68,"B":72},{"name":" concrete 13","R":73,"G":91,"B":36},{"name":" concrete_powder 13","R":97,"G":119,"B":45},{"name":" green_glazed_terracotta 4","R":117,"G":142,"B":67},{"name":" stained_hardened_clay 13","R":76,"G":83,"B":42},{"name":" wool 13","R":85,"G":110,"B":28},{"name":" hay_block 0","R":166,"G":136,"B":38},{"name":" hay_block 4","R":166,"G":139,"B":12},{"name":" iron_block 0","R":220,"G":220,"B":220},{"name":" iron_ore 0","R":136,"G":131,"B":127},{"name":" nether_brick 0","R":4,"G":4,"B":4},{"name":" log 3","R":85,"G":68,"B":25},{"name":" log 7","R":150,"G":109,"B":71},{"name":" planks 3","R":160,"G":115,"B":81},{"name":" lapis_block 0","R":31,"G":67,"B":140},{"name":" lapis_ore 0","R":99,"G":111,"B":133},{"name":" concrete 3","R":36,"G":137,"B":199},{"name":" concrete_powder 3","R":74,"G":181,"B":213},{"name":" light_blue_glazed_terracotta 4","R":95,"G":165,"B":209},{"name":" stained_hardened_clay 3","R":113,"G":109,"B":138},{"name":" wool 3","R":58,"G":175,"B":217},{"name":" concrete 8","R":125,"G":125,"B":115},{"name":" concrete_powder 8","R":155,"G":155,"B":148},{"name":" silver_glazed_terracotta 4","R":144,"G":166,"B":168},{"name":" stained_hardened_clay 4","R":135,"G":107,"B":98},{"name":" wool 4","R":142,"G":142,"B":135},{"name":" concrete 5","R":94,"G":169,"B":24},{"name":" concrete_powder 5","R":125,"G":189,"B":42},{"name":" lime_glazed_terracotta 4","R":163,"G":198,"B":55},{"name":" stained_hardened_clay 5","R":104,"G":118,"B":53},{"name":" wool 5","R":112,"G":185,"B":26},{"name":" concrete 2","R":169,"G":48,"B":159},{"name":" concrete_powder 2","R":193,"G":84,"B":185},{"name":" magenta_glazed_terracotta 4","R":208,"G":100,"B":192},{"name":" stained_hardened_clay 2","R":150,"G":88,"B":109},{"name":" wool 2","R":190,"G":69,"B":180},{"name":" melon_block 0","R":114,"G":146,"B":30},{"name":" mossy_cobblestone 0","R":110,"G":118,"B":95},{"name":" stonebrick 1","R":115,"G":121,"B":105},{"name":" netherrack 0","R":98,"G":38,"B":38},{"name":" quartz_ore 0","R":118,"G":66,"B":62},{"name":" nether_wart_block 0","R":115,"G":3,"B":3},{"name":" noteblock 0","R":89,"G":59,"B":41},{"name":" log 0","R":109,"G":85,"B":51},{"name":" log 4","R":151,"G":122,"B":73},{"name":" planks 0","R":162,"G":131,"B":79},{"name":" obsidian 0","R":15,"G":11,"B":25},{"name":" concrete 1","R":224,"G":97,"B":1},{"name":" concrete_powder 1","R":227,"G":132,"B":32},{"name":" orange_glazed_terracotta 4","R":155,"G":147,"B":92},{"name":" stained_hardened_clay 1","R":162,"G":84,"B":38},{"name":" wool 1","R":241,"G":118,"B":20},{"name":" concrete 6","R":214,"G":101,"B":143},{"name":" concrete_powder 6","R":229,"G":153,"B":181},{"name":" pink_glazed_terracotta 4","R":235,"G":155,"B":182},{"name":" stained_hardened_clay 6","R":162,"G":78,"B":79},{"name":" wool 6","R":238,"G":141,"B":172},{"name":" stone 6","R":132,"G":135,"B":134},{"name":" stone 4","R":193,"G":193,"B":195},{"name":" stone 2","R":154,"G":107,"B":89},{"name":" pumpkin 0","R":196,"G":115,"B":24},{"name":" concrete 10","R":100,"G":32,"B":156},{"name":" concrete_powder 10","R":132,"G":56,"B":178},{"name":" purple_glazed_terracotta 4","R":110,"G":48,"B":152},{"name":" stained_hardened_clay 10","R":118,"G":70,"B":86},{"name":" wool 10","R":122,"G":42,"B":173},{"name":" quartz_block 0","R":236,"G":230,"B":223},{"name":" quartz_block 2","R":236,"G":231,"B":224},{"name":" quartz_block 6","R":235,"G":230,"B":223},{"name":" redstone_block 0","R":148,"G":20,"B":3},{"name":" redstone_ore 0","R":133,"G":108,"B":108},{"name":" concrete 14","R":142,"G":33,"B":33},{"name":" concrete_powder 14","R":168,"G":54,"B":51},{"name":" red_glazed_terracotta 4","R":182,"G":60,"B":53},{"name":" sand 1","R":191,"G":103,"B":33},{"name":" red_sandstone 0","R":187,"G":99,"B":29},{"name":" red_sandstone 3","R":181,"G":98,"B":31},{"name":" stained_hardened_clay 14","R":143,"G":61,"B":47},{"name":" wool 14","R":161,"G":39,"B":35},{"name":" sand 0","R":219,"G":207,"B":163},{"name":" sandstone 0","R":216,"G":203,"B":156},{"name":" sandstone 3","R":224,"G":214,"B":170},{"name":" smooth_stone 0","R":159,"G":159,"B":159},{"name":" snow 0","R":249,"G":254,"B":254},{"name":" soul_sand 0","R":81,"G":62,"B":51},{"name":" sponge 0","R":196,"G":192,"B":75},{"name":" log 1","R":59,"G":38,"B":17},{"name":" log 5","R":109,"G":80,"B":47},{"name":" planks 1","R":115,"G":85,"B":49},{"name":" stone 0","R":126,"G":126,"B":126},{"name":" stonebrick 0","R":122,"G":122,"B":122},{"name":" hardened_clay 0","R":152,"G":94,"B":68},{"name":" tnt 0","R":182,"G":88,"B":84},{"name":" concrete 0","R":207,"G":213,"B":214},{"name":" concrete_powder 0","R":226,"G":227,"B":228},{"name":" white_glazed_terracotta 4","R":188,"G":212,"B":203},{"name":" stained_hardened_clay 4","R":210,"G":178,"B":161},{"name":" wool 4","R":234,"G":236,"B":237},{"name":" concrete 4","R":241,"G":175,"B":21},{"name":" concrete_powder 4","R":233,"G":199,"B":55},{"name":" yellow_glazed_terracotta 4","R":234,"G":192,"B":89},{"name":" stained_hardened_clay 4","R":186,"G":133,"B":35},{"name":" wool 4","R":249,"G":198,"B":40}];
		palette=paletteBE;
		function getMousePos(canvas, event){
			return [Math.round(event.clientX - canvas.getBoundingClientRect().left * canvas.width / canvas.getBoundingClientRect().width + 1), Math.round(event.clientY - canvas.getBoundingClientRect().top * canvas.height / canvas.getBoundingClientRect().height + 1)]
		}
	</script>
</head>
<body>
	<form id="arguments">
		<input type="file" id="upload" accept="image/*">
		 <label for="upload">上传图片</label>
		<br/>
		<fieldset id="img_info" style="display: none;">
		<legend>图片信息</legend>
			<h3 id="img_size"></h3>
		</fieldset>
		<fieldset id="convert_args">
		<legend>转换参数</legend>
			<input type="range" id="rWeight" min="0" max="10" value="1" />
			<label for="rWeight">红色差值权重 1</label>
			<input type="range" id="rScale" min="0" max="200" value="100" />
			<label for="rScale">红色缩放比例 100%</label>
			<br/>
			<input type="range" id="gWeight" min="0" max="10" value="1" />
			<label for="gWeight">绿色差值权重 1</label>
			<input type="range" id="gScale" min="0" max="200" value="100" />
			<label for="gScale">绿色缩放比例 100%</label>
			<br/>
			<input type="range" id="bWeight" min="0" max="10" value="1" />
			<label for="bWeight">蓝色差值权重 1</label>
			<input type="range" id="bScale" min="0" max="200" value="100" />
			<label for="bScale">蓝色缩放比例 100%</label>
			<br/>
			<input type="range" id="caWeight" min="0" max="10" value="0" />
			<label for="caWeight">色差校准权重(Exp) 0</label>
			<select id="fitMode">
				<option value="stdDev" selected>标准差最小</option>
				<option value="stdSqr">标准平方和最小</option>
			</select>
			<label for="commandPlatform">拟合方式</label>
		</fieldset>
		<fieldset id="command_args">
		<legend>命令参数</legend>
			<input type="range" id="xRange" min="1" max="98" value="96" />
			<label for="xRange">图片x轴function分割上限 96</label>
			<br/>
			<input type="range" id="yRange" min="1" max="98" value="96" />
			<label for="yRange">图片y轴function分割上限 96</label>
			</br>
			<input type="checkbox" id="relativePos" />
			<label for="relativePos">使用相对坐标(~)[BUGS TO FIX]</label>
			<input type="checkbox" id="guideFunction" checked />
			<label for="xRange">添加引导function</label>
			<input type="checkbox" id="guideCommand" checked />
			<label for="xRange">function结尾添加引导命令</label>
			<select id="commandPlatform">
				<option value="BE" selected>基岩版</option>
				<option value="JE">JAVA版</option>
			</select>
			<label for="commandPlatform">命令版本</label>
		</fieldset>
		<br/>
	</form>
	<canvas id="img_preview" title="图片预览" style="display: none;"></canvas>
	<br/>
	<button id="convert" style="display: none;">转换</button>
	<button id="download" style="display: none;">下载文件</button>
	<br/>
	<div id="status"></div>
	<canvas id="convert_preview" title="转换预览" style="display: none;"></canvas>
	<script>
		var img=new Image();
		
		rWeight.onchange=(e)=>{
			e.target.labels[0].textContent=`红色差值权重 ${e.target.value}`
		}
		rScale.onchange=(e)=>{
			e.target.labels[0].textContent=`红色缩放比例 ${e.target.value}%`
		}
		gWeight.onchange=(e)=>{
			e.target.labels[0].textContent=`绿色差值权重 ${e.target.value}`
		}
		gScale.onchange=(e)=>{
			e.target.labels[0].textContent=`绿色缩放比例 ${e.target.value}%`
		}
		bWeight.onchange=(e)=>{
			e.target.labels[0].textContent=`蓝色差值权重 ${e.target.value}`
		}
		bScale.onchange=(e)=>{
			e.target.labels[0].textContent=`蓝色缩放比例 ${e.target.value}%`
		}
		caWeight.onchange=(e)=>{
			e.target.labels[0].textContent=`色差校准权重 ${e.target.value}`
		}
		xRange.onchange=(e)=>{
			e.target.labels[0].textContent=`图片x轴function分割上限 ${e.target.value}`
			yRange.max=Math.floor((10000-(guideCommand?2:0))/e.target.value);
		}
		yRange.onchange=(e)=>{
			e.target.labels[0].textContent=`图片y轴function分割上限 ${e.target.value}`
			xRange.max=Math.floor((10000-(guideCommand?2:0))/e.target.value);
		}
		commandPlatform.onchange=(e)=>{
			palette=(e.target.value=="BE"?paletteBE:paletteJE)
		}
		upload.onchange=(()=>{
			if(!upload.files[0]) return;
			var fr=new FileReader();
			fr.onload=()=>{
				img.src=fr.result;
				document.getElementById("convert").style="display: block;";
				document.getElementById("status").innerText="文件已改变，请点击\"转换\"按钮以应用改变";
			}
			fr.readAsDataURL(upload.files[0]);
		})
		img.onload=(()=>{
			img_preview.width=img.width;
			img_preview.height=img.height;
			img_preview.style="display: block;";
			img_size.innerText=`宽：${img.width}    高：${img.height}`
			img_info.style="display: block;";
			img_preview.getContext("2d").drawImage(img,0,0,img.width,img.height);
		})
		convert_args.onchange=(()=>{
			document.getElementById("status").innerText="参数已改变，请"+(upload.files[0]?"点击\"转换\"按钮":"上传图片")+"以应用改变";
		})
		convert.onclick=(()=>{
			if(!upload.files[0]){
				document.getElementById("status").innerText="请上传图片文件";
				return;
			}
			document.getElementById("status").innerText="正在转换...";
			setTimeout(()=>{imgConvert()},50);
		})
		download.onclick=(()=>{
			if(!chunks) return alert("没有什么可下载的");
			if(guideFunction.checked) createFile("help.mcfunction", `say 图片信息：宽：${img.width}  高：${img.height}    图像命令总长度：${img.width*img.height}    function文件数：${chunkList.length}\nsay 输入/function \u0022${chunkList[0].replace(',','-')}\u0022以启动`)
			let n=0;
			let session=setInterval(()=>{
				let chunkPos=chunkList[n];
				let content='';
				for(let i in chunks[chunkPos]){
					content+=`setblock ${relativePos.checked?'~'+(chunks[chunkPos][i][0]-xlimCurrent/2)+" ~ ~"+(chunks[chunkPos][i][1]-ylimCurrent/2):(parseInt(chunkPos.split(',')[0])*xlimCurrent+chunks[chunkPos][i][0])+" ~ "+(parseInt(chunkPos.split(',')[1])*ylimCurrent+chunks[chunkPos][i][1])} ${chunks[chunkPos][i][3]}\n`
				}
				if(guideCommand.checked) content+=chunkList[parseInt(n)+1]?`tp @s ${(relativePos.checked?'~':'')+((relativePos.checked?parseInt(chunkPos.split(',')[0])*xlimCurrent:0)+((parseInt(chunkPos.split(',')[0])+0.5)*xlimCurrent))+" ~ "+(relativePos.checked?'~':'')+(((relativePos.checked?parseInt(chunkPos.split(',')[1])*ylimCurrent:0)+((parseInt(chunkPos.split(',')[1])+0.5)*ylimCurrent)))}\nsay 已传送至下一执行位点,请勿自行移动！请等待区块加载完成后输入/function \u0022${chunkList[parseInt(n)+1].replace(',','-')}\u0022继续生成`:`say 生成完成！`;
				createFile(`${chunkPos.replace(',','-')}.mcfunction`, content);
				n++;
				if(n>=chunkList.length) clearInterval(session);
			},500)
		})
		imgConvert=(()=>{
			convert_preview.width=img_preview.width;
			convert_preview.height=img_preview.height;
			chunks=[];
			chunkList=[];
			for(let y=0;y<img_preview.height;y+=parseInt(yRange.value)){
				for(let x=0;x<img_preview.width;x+=parseInt(xRange.value)){
					chunks[`${Math.floor(x/parseInt(xRange.value))},${Math.floor(y/parseInt(yRange.value))}`]=[];
					chunkList.push(`${Math.floor(x/parseInt(xRange.value))},${Math.floor(y/parseInt(yRange.value))}`);
				}
			}
			xlimCurrent=parseInt(xRange.value)
			ylimCurrent=parseInt(yRange.value)
			imageData=img_preview.getContext("2d").getImageData(0,0,img_preview.width,img_preview.height);
			for(let y=0;y<img_preview.height;y++){
				for(let x=0;x<img_preview.width;x++){
					var convertRGB=getBlock(imageData.data[(y*img_preview.width+x)*4]*(parseInt(rScale.value)/100),imageData.data[(y*img_preview.width+x)*4+1]*(parseInt(gScale.value)/100),imageData.data[(y*img_preview.width+x)*4+2]*(parseInt(bScale.value)/100), (fitMode.value=="stdSqr"), parseInt(rWeight.value),parseInt(gWeight.value),parseInt(bWeight.value),parseInt(caWeight.value));
					chunks[`${Math.floor(x/parseInt(xRange.value))},${Math.floor(y/parseInt(yRange.value))}`].push([x%parseInt(xRange.value), y%parseInt(yRange.value), imageData.data[(y*img_preview.width+x)*4+3], convertRGB.name])
					imageData.data[(y*img_preview.width+x)*4]=convertRGB.R;imageData.data[(y*img_preview.width+x)*4+2]=convertRGB.G;imageData.data[(y*img_preview.width+x)*4+2]=convertRGB.B;
				}
			}
			convert_preview.getContext("2d").putImageData(imageData, 0, 0);
			convert_preview.style="display: block;";
			document.getElementById("status").innerText="转换完成！";
			download.style="display: block;";
		})
		img_preview.onmousemove=((e)=>{
			let pos=getMousePos(e.target, e);
			let pixelData=img_preview.getContext("2d").getImageData(pos[0], pos[1], 1, 1).data;
			e.target.title=`Pos: ${pos[0]},${pos[1]}  R:${pixelData[0]} G:${pixelData[1]} B:${pixelData[2]}`
		})
		convert_preview.onmousemove=((e)=>{
			let pos=getMousePos(e.target, e);
			let convertPixelData=convert_preview.getContext("2d").getImageData(pos[0], pos[1], 1, 1).data;
			let block=getBlock(convertPixelData[0], convertPixelData[1], convertPixelData[2]).name;
			e.target.title=`Pos: ${pos[0]},${pos[1]}  R:${convertPixelData[0]} G:${convertPixelData[1]} B:${convertPixelData[2]}  Block:${block}`
		})
	</script>
</body>